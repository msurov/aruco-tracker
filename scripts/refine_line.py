import cv2
import matplotlib.pyplot as plt
import numpy as np
from scipy.interpolate import UnivariateSpline


def diff(_a):
	a = np.array(_a, dtype=float)
	return (a[2:] - a[:-2]) / 2.


def diff_v2(_a):
	x = np.arange(0, len(_a))
	y = np.array(_a)
	s = UnivariateSpline(x, y, s=1., k=5)
	d = s.derivative()
	return d(x)


def draw_cont(_c):
    c = np.vstack((_c, _c[0]))
    plt.plot(c[:,0], c[:,1])


data = np.array([
[190.28, 211.292, 225.679, 228.977, 230.237, 230.728, 229.99, 229.821, 229.863, 231.169, 231.014, 216.574, 144, 101.885, 105.95, 41.1988, 43.6646, 24.7585, 17.737, 28.8336, 18.5374, 21.9655, 30.9384, 37.3178, 41.4109, ],
[186.495, 212.135, 227.103, 229.819, 230.777, 230.814, 229.691, 230.01, 230.172, 230.084, 229.095, 179.251, 70.0558, 19.7983, 22.3108, 14.385, 36.3808, 26.3512, 20.0191, 35.6679, 40.6399, 42.9989, 41.0606, 41.8613, 42.3112, ],
[189.605, 207.712, 226.261, 229.293, 230.465, 230.173, 229, 229.944, 229.316, 229.098, 234.551, 171.674, 48.2746, 16.9724, 35.3728, 41.8621, 42.0407, 40.7324, 39.9217, 38.936, 39.4737, 42.6723, 41.257, 40.6971, 41.0256, ],
[193.086, 210.617, 225.077, 228.667, 230.444, 231, 230.462, 229.856, 229.187, 229.087, 234.826, 179.577, 19.875, 19.244, 42.5375, 43.9637, 41.9074, 40.6779, 39.9357, 38.7988, 39.0843, 40.6229, 40.2925, 39.8405, 39.7557, ],
[191.896, 211.022, 224.744, 228.708, 230.675, 231, 230.334, 229.389, 227.808, 227.995, 230.576, 162.501, 31.0566, 22.1287, 44.3214, 45.0791, 41.9422, 41.687, 39.9997, 39.0552, 39, 39.2261, 38.7738, 39.5032, 39.3327, ],
[188.657, 205.543, 225.869, 229.956, 231, 230.945, 230, 228.646, 226.228, 225.575, 229.164, 162.754, 58.7604, 29.8447, 41.1358, 43.5967, 41.6081, 39.7995, 38.299, 39.0555, 39.8629, 40.5027, 39.1244, 39.3357, 39.0013, ],
[184.693, 206.329, 225.897, 229.794, 230.579, 230.592, 229.334, 227.385, 225.1, 226.42, 230.742, 177.655, 30, 19.3498, 42.7124, 42.0195, 40.1333, 39.3253, 39.2983, 40.5206, 41.8782, 41.2928, 40.4961, 40.244, 39.668, ],
[181.702, 210.462, 227.557, 229.056, 230.031, 229.552, 228.441, 227.389, 225.914, 227.264, 233.403, 185.289, 61.3787, 19.8963, 43.4075, 42.1119, 39.9438, 40.3985, 42.9491, 41.8073, 41.2317, 41.668, 40.9741, 41.1171, 41.8668, ],
[189.062, 208.849, 227.729, 229.416, 228.738, 228.945, 228, 227.348, 226.966, 226.63, 235.174, 170.533, 52.7751, 24.3401, 38.8124, 41.9999, 41.7716, 42.1923, 42.0438, 42.9113, 44.1928, 44.3673, 44.0554, 45.7048, 43.7228, ],
[193.284, 210.851, 225.529, 228.128, 228.556, 228.612, 227.801, 227.807, 227.3, 226.49, 229.204, 181.594, 20.625, 16.1555, 38.5353, 41.8935, 41.222, 41.0098, 40.3587, 39.0494, 44.1133, 44.663, 39.3149, 32.8282, 23.3032, ],
[191.371, 205.683, 225.967, 227.923, 229.226, 228.524, 227.703, 227.699, 225.836, 226.223, 234.76, 168.178, 36.0017, 19.7934, 40.0901, 40.8371, 40.0065, 37.5412, 31.0366, 24.2422, 21.8504, 26.097, 14.9863, 11.7143, 25.4742, ],
[191.169, 203.272, 226.069, 228, 228, 228, 228, 227.826, 225.966, 225.009, 232.004, 166.871, 56.7186, 27.5449, 39.5094, 40.2215, 28.264, 20.5485, 37.5613, 37.3291, 21.1489, 61.4414, 72.321, 138.526, 147.924, ],
[192.293, 205.459, 222.735, 227.543, 227.872, 227.689, 227.196, 226.897, 226.411, 225.833, 226.84, 178.865, 43.5, 20.4207, 40.1457, 41.3434, 12.4337, 39.6046, 119.692, 154.654, 175.038, 188.18, 220.484, 234.671, 231.745, ],
[192.599, 200.206, 222.515, 226.446, 226.981, 226.52, 226.477, 226.712, 226.318, 227.499, 235.165, 183.24, 58.1982, 16.499, 42.6669, 38.5642, 7.51485, 40.7702, 209.574, 246.36, 233.99, 237.491, 240.992, 238.991, 237.826, ],
[191.059, 202.311, 222.258, 226.104, 226.96, 226.732, 227, 227.888, 226.842, 227.561, 236.99, 178.97, 57.2196, 24.9388, 39.2797, 31.6675, 14.1671, 79.4349, 205.098, 238.454, 233.931, 232.463, 232.893, 234.828, 238.475, ],
[186.848, 199.173, 218.706, 225.502, 226.443, 227, 227.115, 227.018, 226.625, 226.772, 227.499, 178.859, 16, 8.98088, 42.2676, 39.747, 19.9436, 90.687, 207.823, 235.251, 230.731, 231.082, 232.66, 235.819, 238.324, ],
[188.105, 196.087, 217.198, 224.724, 226.03, 226.824, 227.463, 227.976, 226.537, 228.563, 237.899, 170.107, 44.3362, 21.3469, 44.6381, 41.9586, 5.3149, 49.6645, 225.699, 235.271, 229.763, 231.399, 231.912, 233.767, 235.958, ],
[189.513, 195.681, 218.231, 224.539, 226.111, 227, 227, 227.066, 226.693, 224.982, 233.908, 176.238, 61.8851, 27.2678, 41.2837, 38.4864, 26.1286, 75.1479, 198.348, 236.478, 237.702, 232.994, 233.349, 225.732, 231.856, ],
[189.064, 202.742, 219.21, 225.189, 226.054, 226.664, 227.333, 227.397, 226.02, 224.814, 227.38, 200.164, 52.75, 20.6129, 43.4788, 41.2194, 17.2724, 77.1397, 201.396, 245.308, 220.441, 195.256, 183.52, 176.972, 212.091, ],
[188.85, 200.453, 220.121, 224.336, 226.464, 226.863, 227.547, 227.298, 225.677, 226.917, 233.117, 185.467, 55.8236, 14.9277, 41.8264, 40.205, 28.6507, 54.4542, 191.824, 167.115, 96.4706, 73.6957, 57.1216, 90.698, 186.751, ],
[188.115, 199.675, 221.795, 223.499, 226.381, 227.466, 227.138, 227.011, 226.504, 224.497, 233.979, 195.775, 67.7744, 21.2392, 36.4662, 43.2283, 35.7752, 33.4927, 45.0788, 32.4263, 14.3128, 16.2271, 22.1429, 44.7434, 192.522, ],
[185.623, 203.486, 220.73, 224.499, 226.888, 228, 228, 228.045, 227.995, 226.314, 226.659, 199.383, 21.375, 15.7707, 37.5744, 41.791, 39.4986, 29.5794, 21.2306, 30.4609, 33.7152, 34.2702, 27.3811, 71.5578, 186.9, ],
], dtype=float)

# for i,v in enumerate(data):
# 	d = diff(v)
# 	plt.clf()
# 	plt.plot(v)
# 	plt.title(str(i))
# 	plt.pause(0.2)

# plt.imshow(data, interpolation='nearest', cmap='gray')

# print len(data)

# plt.plot(diff(data[19,:]))
# plt.plot(data[19,:])

im = cv2.imread('/home/msurov/dev/datasets/aruco6/10.png', 0)
plt.imshow(im, interpolation='nearest', cmap='gray')

draw_cont([[682.501, 760.255], [698.467, 714.264], [746.594, 720.097], [731.491, 766.507]])
draw_cont([[879.549, 197.435], [888.681, 170.615], [927.201, 171.945], [918.163, 198.847]])
draw_cont([[1167.57, 354.145], [1170.68, 388.078], [1120.12, 386.392], [1115.3, 353.379]])
draw_cont([[1097.15, 553.505], [1074.52, 593.109], [1028.3, 576.327], [1051.39, 537.412]])
draw_cont([[1363.83, 839.264], [1367.69, 788.105], [1423.85, 793.752], [1421.13, 844.954]])
draw_cont([[682.52, 760.266], [698.445, 714.272], [746.592, 720.11], [731.492, 766.512]])
draw_cont([[879.564, 197.438], [888.704, 170.652], [927.201, 171.931], [918.199, 198.846]])
draw_cont([[1167.58, 354.165], [1170.7, 388.076], [1120.12, 386.365], [1115.3, 353.396]])
draw_cont([[1097.13, 553.497], [1074.54, 593.109], [1028.26, 576.331], [1051.39, 537.414]])
draw_cont([[1363.84, 839.265], [1367.68, 788.095], [1423.88, 793.774], [1421.12, 844.932]])
draw_cont([[682.517, 760.26], [698.451, 714.254], [746.589, 720.095], [731.487, 766.51]])
draw_cont([[879.552, 197.429], [888.673, 170.64], [927.215, 171.941], [918.174, 198.842]])
draw_cont([[1167.56, 354.136], [1170.72, 388.07], [1120.1, 386.363], [1115.35, 353.383]])
draw_cont([[1097.13, 553.511], [1074.51, 593.111], [1028.29, 576.311], [1051.38, 537.382]])
draw_cont([[1363.84, 839.253], [1367.7, 788.089], [1423.88, 793.754], [1421.14, 844.935]])
draw_cont([[682.513, 760.267], [698.454, 714.256], [746.609, 720.105], [731.485, 766.519]])
draw_cont([[879.544, 197.439], [888.712, 170.624], [927.217, 171.954], [918.171, 198.846]])
draw_cont([[1167.57, 354.118], [1170.69, 388.061], [1120.11, 386.386], [1115.32, 353.384]])
draw_cont([[1097.14, 553.504], [1074.53, 593.114], [1028.29, 576.312], [1051.39, 537.406]])
draw_cont([[1363.84, 839.273], [1367.69, 788.103], [1423.86, 793.761], [1421.14, 844.94]])
draw_cont([[682.514, 760.265], [698.463, 714.268], [746.597, 720.111], [731.494, 766.516]])
draw_cont([[879.558, 197.447], [888.671, 170.635], [927.195, 171.946], [918.184, 198.84]])
draw_cont([[1167.58, 354.161], [1170.68, 388.096], [1120.11, 386.345], [1115.32, 353.373]])
draw_cont([[1097.13, 553.493], [1074.54, 593.11], [1028.29, 576.346], [1051.37, 537.417]])
draw_cont([[1363.83, 839.265], [1367.71, 788.095], [1423.86, 793.75], [1421.14, 844.95]])
draw_cont([[682.513, 760.249], [698.455, 714.254], [746.588, 720.096], [731.5, 766.502]])
draw_cont([[879.563, 197.424], [888.69, 170.624], [927.212, 171.953], [918.171, 198.857]])
draw_cont([[1167.57, 354.166], [1170.7, 388.026], [1120.12, 386.34], [1115.3, 353.404]])
draw_cont([[1097.11, 553.503], [1074.52, 593.114], [1028.28, 576.309], [1051.41, 537.402]])
draw_cont([[1363.83, 839.281], [1367.7, 788.11], [1423.86, 793.755], [1421.13, 844.929]])
draw_cont([[682.523, 760.243], [698.438, 714.272], [746.612, 720.104], [731.481, 766.523]])
draw_cont([[1167.57, 354.169], [1170.68, 388.084], [1120.11, 386.392], [1115.3, 353.392]])
draw_cont([[1097.15, 553.506], [1074.52, 593.113], [1028.27, 576.33], [1051.38, 537.425]])
draw_cont([[1363.83, 839.262], [1367.7, 788.085], [1423.86, 793.769], [1421.15, 844.951]])
draw_cont([[682.514, 760.263], [698.46, 714.279], [746.604, 720.092], [731.489, 766.505]])
draw_cont([[879.546, 197.435], [888.688, 170.661], [927.2, 171.925], [918.172, 198.841]])
draw_cont([[1167.56, 354.148], [1170.7, 388.075], [1120.11, 386.334], [1115.31, 353.385]])
draw_cont([[1097.13, 553.503], [1074.51, 593.111], [1028.29, 576.333], [1051.38, 537.399]])
draw_cont([[1363.85, 839.261], [1367.69, 788.09], [1423.86, 793.748], [1421.17, 844.947]])
draw_cont([[682.533, 760.236], [698.448, 714.256], [746.604, 720.074], [731.505, 766.513]])
draw_cont([[879.564, 197.417], [888.696, 170.623], [927.186, 171.947], [918.192, 198.856]])
draw_cont([[1167.58, 354.181], [1170.69, 388.082], [1120.15, 386.319], [1115.3, 353.395]])
draw_cont([[1097.15, 553.506], [1074.51, 593.11], [1028.29, 576.312], [1051.4, 537.395]])
draw_cont([[1363.83, 839.269], [1367.69, 788.092], [1423.85, 793.762], [1421.15, 844.955]])
draw_cont([[682.508, 760.246], [698.452, 714.271], [746.6, 720.118], [731.478, 766.528]])
draw_cont([[879.557, 197.433], [888.667, 170.662], [927.185, 171.937], [918.19, 198.846]])
draw_cont([[1167.58, 354.144], [1170.7, 388.087], [1120.12, 386.376], [1115.3, 353.393]])
draw_cont([[1097.12, 553.516], [1074.52, 593.111], [1028.27, 576.326], [1051.39, 537.404]])

plt.grid()
plt.show()
